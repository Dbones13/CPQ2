preSelectDict = {'Display Size_EAPP': '27 inch NTS NEC','Display Size _ACE_desk_pre': '27 inch NTS NEC','DMS Display size': '27 inch NTS NEC','DMS Display size': '24 inch Touch Dell','Cabinet_Display_size': '27 inch NTS NEC','Cabinet_Display_size': '24 inch Touch Dell','Display_Size_FlexServer': '27 inch NTS NEC','Tablet Hardware selection': 'STN_TAB_DELL_RUG','Server Type1': 'SVR_STD_DELL_Rack_RAID1','Ent_ace_t_desk_tpm': 'Yes','QVCS Support': 'No','Experion Server Type': 'Server TPS','Default Switch': 'Twenty Four STP Port CISCO Switch','Cabinet_Industrial_KB_Mouse': 'No','CMS TPS Station Hardware Selection': 'STN_PER_DELL_Rack_RAID1','DMS Industrial KB Mouse': 'No','DMS TPS Station Hardware Selection': 'STN_PER_DELL_Tower_RAID1','ACE Rapid Restart License': 'No','CMS Cabinet Station Mounting Type': 'None','CMS Console Station Extension Hardware Selection': 'STN_PER_DELL_Tower_RAID1','CMS Console Station Hardware Selection': 'STN_PER_DELL_Tower_RAID1','Cabinet_Display_Supplier': 'Honeywell','DMS Console Station Extension Hardware Selection': 'STN_STD_DELL_Tower_NonRAID','DMS Console Station Hardware Selection': 'STN_STD_DELL_Tower_NonRAID','DMS Multi Window Support Option Required?': 'No','DMS Flex Station Hardware Selection': 'STN_STD_DELL_Tower_NonRAID','Cabinet_Touch_Screen_required': 'No Touch Screen','Cabinet_Trackball_required': 'No','Cabinet_Industrial_KB_Mouse': 'No','Cabinet_IKB_or_OEP': 'None','Server Mounting': 'Desk','Additional_Station_Cabinet_Mounting_Type': 'None','Ent_sim_desk_tpm': 'Yes','Ent_app_cab_tpm': 'Yes','Ent_app_desk_tpm': 'Yes','Ent_sim_cab_tpm': 'Yes','Ent_ace_t_Cab_tpm': 'Yes','CMS Multi Window Support Option Required?': 'No','CMS Flex Station Hardware Selection': 'STN_PER_DELL_Tower_RAID1','Node Supplier Server1': 'Honeywell','Hardware Design Selection_ACE_T_Node': 'SVR_STD_DELL_Tower_RAID1','Display Supplier (ACE-T)': 'Honeywell','Display Size (ACE-T)': '27 inch NTS NEC','Additional Memory (ACE-T)': 'None','Trusted Platform Module_TPM_ACE_T': 'Yes','Node_Supplier_ACE_T': 'Honeywell','Hardware Design Selection': 'SVR_STD_DELL_Tower_RAID1','Experion Server Type': 'Server','Server_NodeType': 'SVR_PER_DELL_Rack_RAID5','Rack_Mounting_Type': 'None','Optional_DVD_ServerDisk': 'Yes','AdditionalHard_Disk': 'No','TrustedPlatformModule_TPM': 'Yes','Node_Supplier_Server': 'Honeywell','Server_NodeType': 'SVR_STD_DELL_Rack_RAID1','Server_NodeType': 'SVR_STD_DELL_Rack_RAID1','RPS Mounting Furniture (Flex Server Cabinet)': 'Desk','Flex Server Rack Mounting Type': 'Fixed Mount','': 'None','Multi Window Support (Flex Server)': 'No','TrustedPlatform_Module_TPM': 'Yes','Node Supplier (Flex Server)': 'Honeywell','Flex Server Node Type': 'SVR_F_PER_DELL_Tower_RAID1','ServerLocation_Cluster/Network_Group': 'Location/Cluster/Network Group 1','Trackball': 'No','Display_Supplier': 'Honeywell','Remote_Peripheral_Solution_Type_RPS': 'None','Display_Size_FlexServer': '24 inch Touch Dell','TouchScreen_FlexServerDesk': 'No','Multi_WindowSupportFlex_Server': 'No','TrustedPlatform_ModuleTPM': 'Yes','NodeSupplier_FlexServer': 'Honeywell','IKBorOEP_FlexServer': 'None','Trackball _Server': 'No','Display Size_server': '27 inch NTS NEC','Optional DVD_Server Disk': 'No','Additional Memory_Server Disk': 'None','Trusted Platform Module1': 'Yes','Node Supplier_server': 'Honewell','Server Node Type_desk': 'SVR_PER_DELL_Rack_RAID5','Server Node Type_desk': 'SVR_STD_DELL_Tower_RAID1','LAN Type': 'Ethernet','LAN Type': 'FTE','Network Interface Card Type': 'Onboard','ELCN Solution Required': 'No','Server Redundancy Requirement?': 'Non Redundant','Experion Server Type': 'Server','Display Supplier (Mobile Server)': 'Honeywell','Display Size (Mobile Server)': '27 inch NTS NEC','Trackball (Mobile server)': 'No','Optional DVD (Mobile Server)': 'No','Additional Hard Disk (Mobile Server)': 'No','Additional Memory (Mobile Server)': 'None','Node Supplier Server': 'Honeywell','Hardware Selection': 'SVR_STD_DELL_Rack_RAID1','Orion Console Lift Jack System': 'No','Orion Console Alarm Soundbar': 'No','Extended Height Alarm Light Panel': 'No','Custom Logo on Alarm Panel': 'No','Displays_ace_desk_pre': '0','Orion Console Remote Periph Sol Type (RPS)': 'None','Orion Cons Annunc Rly Cont Box Required (IKB/OEP)': 'No','Orion Console Membrane KB Type': 'None','Orion Console Display Supplier': 'Honeywell','Orion Console Display Size': '55 inch NTS','Turret location in Extended Auxil Equip Unit': 'Center','Orion Console Turret Type': 'None','': '0','Hardware Design Selection_ACE Node': 'SVR_STD_DELL_Rack_RAID1','Display_Supplier_EAPP': 'Honeywell','Display Supplier_EAPP': 'Honeywell','Optional DVD (Sim PC Cab)': 'No','Additional Hard Disk (Sim PC Desk)': 'No','Additional Memory (Sim PC Cab)': 'None','Rack Mounting Type for SIM PC Node': 'None','Node Supplier (Sim PC)1': 'Honeywell','Hardware Design Selection - Sim PC Node': 'SVR_STD_DELL_Rack_RAID1','Trackball (Sim PC)': 'No','Hardware Design Selection - EAPP Node': 'SVR_STD_DELL_Tower_RAID1','Display Supplier (Sim PC)': 'Honeywell','Optional DVD (Sim PC Desk)': 'No','Additional Hard Disk (Sim PC Desk)': 'No','Additional Memory (Sim PC Desk)': 'None','Node_Supplier_EAPP': 'Honeywell','Node Supplier_EAPP': 'Honeywell','Display Size (Sim PC)': '27 inch NTS NEC','Node Supplier (Sim PC)': 'Honeywell','Hardware Design Selection - Sim PC Node1': 'SVR_STD_DELL_Tower_RAID1','Interface with TPS Required?': 'No','Hardware Design Selection - EAPP Node': 'SVR_STD_DELL_Tower_RAID1','Displays_server01': '1','Displays_EAPP': '0','Experion UOC Regulatory Compliance Points (0-61440)': '0','Experion UOC PROFINET Usage License (0-30)': '0','Experion UOC Digital Points (0-61440)': '0','Experion UOC Composite Device License (0-61440)': '0','Experion UOC Batch Points (0-61440)': '0','Experion UOC Analog Points (0-61440)': '0','Experion UOC Advanced Batch Points (0-61440)': '0','Experion Backup & Restore (Console)': 'No','Experion Backup & Restore (Console Station ES-C)': 'No','Experion Backup & Restore (Flex Station ES-F)': 'No','Experion Backup & Restore (Mobile Terminal Server)': 'No','Experion Backup & Restore (Simulation PC)': 'No','Experion Backup & Restore (ACE)': 'No','Experion Backup & Restore (Experion Server)': 'No','Backbone Switch Required': 'No','PDU Power Cable Req for HP/ Huawei Switch': 'No','Power Cord Type': 'US','Default Crossover Cable': '2M','Orion Stations required': 'No','Multi-Window Support Option Required?': 'No','Node Supplier': 'Honeywell','Console Station Extension Hardware Selection': 'STN_PER_DELL_Tower_RAID1','TPS Station Hardware Selection': 'STN_PER_DELL_Tower_RAID1','Console Station Hardware Selection': 'STN_PER_DELL_Tower_RAID1','Flex Station Hardware Selection TPS': 'STN_PER_DELL_Tower_RAID1','Experion Backup & Restore ConsoleStation Extension': 'No','Experion Backup & Restore (TPS Station ES-T)': 'No','Experion Backup & Restore (Flex Station ES-F)1': 'No','Experion Backup & Restore (Simulation PC)1': 'No','Experion Backup & Restore (Experion APP)': 'No','Experion Backup & Restore (ACE-T)': 'No','Experion Backup & Restore (ACE)1': 'No','Experion Backup & Restore (Experion TPS Server)': 'No','Station Type': 'STN_STD_DELL_Tower_NonRAID','Keylock Type': 'Standard','Optimize Station License Across Groups': 'No','Cabinet Thermostat': 'No','Cabinet Hinge Type': '130 Degree','Cabinet Doors': 'Standard','Cabinet Color': 'GrayRAL7032','Cabinet Base': 'No','Additional Server Cabinet Mounting Type': 'None','Additional Server Furniture': 'Desk','Server used to host ARO Server Virtual Machine (s)': 'No','Trusted Platform Module_TPM': 'No','Ethernet/IP Interface for Series C(0-100)': '0','Node Supplier Server': 'Honeywell','Node Supplier (Additional Station)': 'Honeywell'}
for tab in Product.Tabs:
	if tab.Name == 'General Inputs':
		for attr in tab.Attributes:
			if attr.Allowed == True and not attr.GetValue():
				key = attr.Name
				if key in preSelectDict:
					if key != 'Server Type1' and Quote.GetCustomField("R2QFlag").Content !='Yes':
						attr.SelectValue(preSelectDict[key])

Log.Info("cab desk server type1 " +str(Product.Attr('server type1').GetValue()))
cab = Product.Attr('CMS Cabinet Mounting Stations required').GetValue()
desk = Product.Attr('DMS Desk Mounting Stations required').GetValue()
orion = Product.Attr('Orion Stations required').GetValue()
Trace.Write(cab)
#displays =Product.Attr('Cabinet_No_of_Displays (0-4)').GetValue()
#DMS_display = Product.Attr('DMS No of Displays 0_4').GetValue()
MIB = Product.Attr('MIB Configuration Required?').GetValue()

if cab == 'Yes':
	displaySize= Product.Attributes.GetByName('Cabinet_Display_size').GetValue()
	flexQty = Product.Attributes.GetByName('CMS Flex Station Qty 0_60').GetValue() or 0
	cmsCS = cmsEX = 0
	if MIB == 'No':
		Trace.Write("no")
		cmsCS = Product.Attributes.GetByName('CMS Console Station Qty 0_20').GetValue() if Product.Attributes.GetByName('CMS Console Station Qty 0_20').GetValue() else 0
		Trace.Write(str(cmsCS))
		cmsEX = Product.Attributes.GetByName('CMS Console Station Qty 0_20').GetValue() if Product.Attributes.GetByName('CMS Console Station Extension Qty 0_15').GetValue() else 0
		Trace.Write(str(cmsEX))
	var1 = int(flexQty) + int(cmsCS) + int(cmsEX)
	Trace.Write(str(var1))
	if var1 > 0:
		Product.AllowAttr('CMS Multi Window Support Option Required?')
	else:
		Product.DisallowAttr('CMS Multi Window Support Option Required?')
	Trace.Write(var1)
	displays =Product.Attr('Cabinet_No_of_Displays (0-4)').GetValue() or 0
	try:
		cms_MW = Product.Attr('CMS Multi Window Support Option Required?').GetValue()
	except:
		cms_MW = 'No'
	if var1 > 0:
		if int(displays) > 1 :
			for value in Product.Attr('CMS Multi Window Support Option Required?').Values:
				if value.Display == 'No':
					value.Allowed = False
				else:
					value.Allowed = True
			Product.Attr("CMS Multi Window Support Option Required?").Access = AttributeAccess.ReadOnly
		else :
			for value in Product.Attr('CMS Multi Window Support Option Required?').Values:
				if value.Display == 'No':
					value.Allowed = True
				elif displaySize == "55 inch NTS" and value.Display=="Yes":
					value.Allowed = False
			Product.Attr("CMS Multi Window Support Option Required?").Access = AttributeAccess.Editable
	if Quote:
		LOB=Quote.GetCustomField("Booking LOB").Content
		if (int(flexQty)>=1 or int(cmsCS)>=1 or int(cmsEX)>=1) and int(displays)>1 and LOB=="PAS":
			Product.DisallowAttr('CMS Multi Window Support Option Required?')
			
	if int(displays) <= 1 and cms_MW == 'Yes':
		Product.AllowAttr('CMS Message 8')
		Trace.Write('***************************************')
	else:
		Product.DisallowAttr('CMS Message 8')

if desk == 'Yes':
	dmsFlexQty = Product.Attributes.GetByName('DMS Flex Station Qty 0_60').GetValue() or 0
	dmsCS = Product.Attributes.GetByName('DMS Console Station Qty 0_20').GetValue() or 0
	dmsEX = Product.Attributes.GetByName('DMS Console Station Extension Qty 0_15').GetValue() or 0
	DMS_display = Product.Attr('DMS No of Displays 0_4').GetValue() or '0'
	Dms_Display_size = Product.Attr('DMS Display size').GetValue()
	
	var2 = int(dmsFlexQty) + int(dmsCS) + int(dmsEX)
	if var2 > 0:
		Product.AllowAttr('DMS Multi Window Support Option Required?')
	else:
		Product.DisallowAttr('DMS Multi Window Support Option Required?')
	try:
		dms_MW = Product.Attr('DMS Multi Window Support Option Required?').GetValue()
	except:
		dms_MW = 'No'
	if var2 > 0:
		if int(DMS_display) > 1 and Dms_Display_size=="55 inch NTS":
			Product.Attr('DMS No of Displays 0_4').AssignValue('1')
			DMS_display='1'
		if int(DMS_display) > 1:
			for value in Product.Attr('DMS Multi Window Support Option Required?').Values:
				if value.Display == 'No':
					value.Allowed = False
			Product.Attr("DMS Multi Window Support Option Required?").Access = AttributeAccess.ReadOnly
			Product.Attr('DMS Multi Window Support Option Required?').SelectValue('Yes')
		else:
			for value in Product.Attr('DMS Multi Window Support Option Required?').Values:
				if value.Display == 'No':
					value.Allowed = True
				elif Dms_Display_size == "55 inch NTS" and value.Display=="Yes":
					value.Allowed = False
			Product.Attr("DMS Multi Window Support Option Required?").Access = AttributeAccess.Editable

	if Quote:
		LOB=Quote.GetCustomField("Booking LOB").Content
		if (int(dmsFlexQty)>=1 or int(dmsCS)>=1 or int(dmsEX)>=1) and int(DMS_display)>1 and LOB=="PAS":
			Product.DisallowAttr('DMS Multi Window Support Option Required?')

	if int(DMS_display) <= 1 and dms_MW == 'Yes':
		Product.AllowAttr('DMS Message 8')
	else:
		Product.DisallowAttr('DMS Message 8')
if orion == "Yes":
	orion_Display_size = Product.Attr('Orion Console Display Size').GetValue()
	orion_flex_station_qty = Product.Attr('Flex Station Qty (0-60)').GetValue()
	if orion_Display_size == "55 inch NTS":
		Product.Attr('Orion Console Display Devices (0-4)').AssignValue('1')
		for value in Product.Attr('Multi-Window Support Option Required?').Values:
			Trace.Write(value.Display)
			if value.Display == "Yes":
				value.Allowed = False

import GS_DropDown_Implementation
GS_DropDown_Implementation.SetDropDownDefaultvalue(Product)